<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Domains &mdash; Chapel Documentation 2.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/style.css?v=70f659a1" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=b21de401"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Arrays" href="arrays.html" />
    <link rel="prev" title="Ranges" href="ranges.html" />
   
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>2.2
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "2.2";
$pagename = "primers/domains";
include "..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../developer/index.html">Docs for Contributors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Primers</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="index.html#language-basics">Language Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#iterators">Iterators</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#task-parallelism">Task Parallelism</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#locality">Locality</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html#data-parallelism">Data Parallelism</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="ranges.html">Ranges</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Domains</a></li>
<li class="toctree-l3"><a class="reference internal" href="arrays.html">Arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="slices.html">Slices</a></li>
<li class="toctree-l3"><a class="reference internal" href="distributions.html">Distributions</a></li>
<li class="toctree-l3"><a class="reference internal" href="forallLoops.html">Forall Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="sparse.html">Sparse Domains and Arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="associative.html">Associative Domains and Arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="reductions.html">Reductions</a></li>
<li class="toctree-l3"><a class="reference internal" href="replicated.html">Replicated Distribution</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="index.html#interoperability">Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#library-utilities">Library Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#numerical-libraries">Numerical Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#tools">Tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#language-overview">Language Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mason-packages/index.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

  <p class="caption" role="heading"><span class="caption-text">Indexes</span></p>
  <ul>
    <li class="toctree-11"><a class="reference internal" href="../chpl-modindex.html">Chapel Module Index</a></li>
    <li class="toctree-11"><a class="reference internal" href="../genindex.html">Complete Docs Index</a></li>
  </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Chapel Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Primers</a></li>
      <li class="breadcrumb-item active">Domains</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/primers/domains.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="domains">
<span id="primers-domains"></span><h1>Domains<a class="headerlink" href="#domains" title="Link to this heading">¶</a></h1>
<p><a class="reference external" href="https://github.com/chapel-lang/chapel/blob/main/test/release/examples/primers/domains.chpl">View domains.chpl on GitHub</a></p>
<p>This primer showcases Chapel domains as abstract concepts, primarily
within the context of rectangular domains.  For other uses of domains
see the following primers:</p>
<blockquote>
<div><ul class="simple">
<li><p>Arrays primer (<a class="reference internal" href="arrays.html#primers-arrays"><span class="std std-ref">arrays.chpl</span></a>)</p></li>
<li><p>Sparse arrays primer (<a class="reference internal" href="sparse.html#primers-sparse"><span class="std std-ref">sparse.chpl</span></a>)</p></li>
<li><p>Associative arrays primer (<a class="reference internal" href="associative.html#primers-associative"><span class="std std-ref">associative.chpl</span></a>)</p></li>
</ul>
</div></blockquote>
<p>A domain is a first-class representation of an index set used to
specify iteration spaces, define arrays, and aggregate operations
such as slicing.</p>
<p>Rectangular domains are used to represent rectangular index sets.
Each dimension of a rectangular domain is specified by a range and
thus can take on the shape of any range.  See the Ranges primer
(<a class="reference internal" href="ranges.html#primers-ranges"><span class="std std-ref">ranges.chpl</span></a>) for more information.</p>
<p>Rectangular domains support a literal syntax that is a
comma-separated list of range expressions enclosed in curly braces.</p>
<p><code class="docutils literal notranslate"><span class="pre">RD</span></code> is an n by n by n domain.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">config</span> <span class="kd">var</span> <span class="nx">n</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">RD</span><span class="p">:</span> <span class="k">domain</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="p">,</span> <span class="mi">1</span><span class="o">..</span><span class="nx">n</span><span class="p">};</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RD</span><span class="p">);</span> <span class="c1">// {1..10, 1..10, 1..10}</span>
</pre></div>
</div>
<p>Rectangular domains have a set of methods that enable convenient
reuse of existing domains.</p>
<p>The <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.expand" title="ChapelDomain.expand"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">expand</span></code></a> method returns a new domain that is expanded or
contracted in each dimension depending on the value and sign of the offset
argument.  The expansion/contraction in each dimension happens symmetrically to
the lower and upper bound.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RDexp</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">expand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">2</span><span class="p">));</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDexp</span><span class="p">);</span> <span class="c1">// {0..11, -1..12, 3..8}</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.exterior" title="ChapelDomain.exterior"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">exterior</span></code></a> method returns a new domain that is an
exterior portion of the current domain.  This is not the “border” of the
domain (which is not a rectangular domain), in particular the new domain
will share no indices with the original domain unless an offset is 0, in which
case the respective range will be that of the original domain.
Inputs specify the width of the new domain in the respective dimension.
A positive value specifies that the exterior should be taken from the high
bound; a negative offset, the low bound.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RDext1</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">exterior</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">));</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDext1</span><span class="p">);</span> <span class="c1">// {11..11, 11..14, -3..0}</span>
<span class="kd">var</span> <span class="nx">RDext2</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">exterior</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">0</span><span class="p">));</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDext2</span><span class="p">);</span> <span class="c1">// {1..10, 11..14, 1..10}</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.interior" title="ChapelDomain.interior"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">interior</span></code></a> method returns a new domain that is the
interior portion of the current domain.  Inputs specify the width
of the new domain in the respective dimension.  The sign of the offset implies
using the high or low bound as in the exterior case.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RDint</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">interior</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">1</span><span class="p">));</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDint</span><span class="p">);</span> <span class="c1">// {9..10, 1..5, 10..10}</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.translate" title="ChapelDomain.translate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">translate</span></code></a> method returns a new domain that is the
current domain translated by the offset.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RDtrans1</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">translate</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="o">-</span><span class="mi">4</span><span class="p">));</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDtrans1</span><span class="p">);</span> <span class="c1">// {1..10, 5..14, -3..6}</span>
</pre></div>
</div>
<p>All four functions above
(<a class="reference internal" href="../language/spec/domains.html#ChapelDomain.expand" title="ChapelDomain.expand"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">expand</span></code></a>, <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.exterior" title="ChapelDomain.exterior"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">exterior</span></code></a>,
<a class="reference internal" href="../language/spec/domains.html#ChapelDomain.interior" title="ChapelDomain.interior"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">interior</span></code></a>, <a class="reference internal" href="../language/spec/domains.html#ChapelDomain.translate" title="ChapelDomain.translate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">translate</span></code></a>)
may also be called with a single offset, in which case the offset will
apply to all dimensions.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RDtrans2</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">.</span><span class="nx">translate</span><span class="p">(</span><span class="mi">4</span><span class="p">);</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">RDtrans2</span><span class="p">);</span> <span class="c1">// {5..14, 5..14, 5..14}</span>
</pre></div>
</div>
<p>A subdomain is a domain that is declared in terms of a parent
domain, causing it to have the same type as their parent.  A
subdomain represents a subset of its parent domain’s index set,
though this constraint is not currently enforced by the
implementation.</p>
<p>Create rectangular subdomains.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Sparse domains and arrays are currently unstable.
Their functionality is likely to change in the future.</p>
</div>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">RSD1</span><span class="p">,</span> <span class="nx">RSD2</span> <span class="p">:</span> <span class="k">subdomain</span><span class="p">(</span><span class="nx">RD</span><span class="p">);</span>
</pre></div>
</div>
<p>A subdomain is initially empty.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;RSD1:&quot;</span><span class="p">,</span> <span class="nx">RSD1</span><span class="p">);</span> <span class="c1">// RSD1:{1..0, 1..0, 1..0}</span>
<span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;RSD2:&quot;</span><span class="p">,</span> <span class="nx">RSD2</span><span class="p">);</span> <span class="c1">// RSD2:{1..0, 1..0, 1..0}</span>
</pre></div>
</div>
<p>We can select parts of the original rectangular domain using slicing.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">RSD1</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">[</span><span class="o">..</span><span class="nx">n</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="o">..</span><span class="p">,</span> <span class="o">..</span><span class="p">];</span>   <span class="c1">// This gives half of the domain,</span>
<span class="nx">RSD2</span> <span class="o">=</span> <span class="nx">RD</span><span class="p">[</span><span class="nx">n</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="o">..</span><span class="p">,</span> <span class="o">..</span><span class="p">,</span> <span class="o">..</span><span class="p">];</span> <span class="c1">// and this gives the other half.</span>

<span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;RSD1:&quot;</span><span class="p">,</span> <span class="nx">RSD1</span><span class="p">);</span> <span class="c1">// RSD1:{1..5, 1..10, 1..10}</span>
<span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;RSD2:&quot;</span><span class="p">,</span> <span class="nx">RSD2</span><span class="p">);</span> <span class="c1">// RSD2:{6..10, 1..10, 1..10}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Subdomains of rectangular domains are regular unless they are explicitly
declared to be sparse.</p></li>
<li><p>At present, range checking to ensure that a subdomain fits within its
parent domain is unimplemented.</p></li>
</ul>
</div>
<p>Create a sparse subdomain of a regular domain.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">SSD</span><span class="p">:</span> <span class="k">sparse</span> <span class="k">subdomain</span><span class="p">(</span><span class="nx">RD</span><span class="p">);</span>

<span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;SSD:&quot;</span><span class="p">,</span> <span class="nx">SSD</span><span class="p">);</span> <span class="c1">// Initially empty.</span>
</pre></div>
</div>
<p>Add some indices to the sparse subdomain.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="nx">SSD</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="nx">SSD</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">);</span>
<span class="nx">SSD</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">);</span>
<span class="nx">SSD</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

<span class="nx">writeln</span><span class="p">(</span><span class="s">&quot;SSD:&quot;</span><span class="p">,</span> <span class="nx">SSD</span><span class="p">);</span> <span class="c1">// Now contains an unordered set of indices.</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Checks to ensure that sparse subdomain indices lie within the parent domain
have not been implemented.</p>
</div>
<p>For more information on domains, see the Domains chapter of the
<a class="reference internal" href="../language/spec/index.html#chapel-spec"><span class="std std-ref">Chapel Language Specification</span></a>.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="ranges.html" class="btn btn-neutral float-left" title="Ranges" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="arrays.html" class="btn btn-neutral float-right" title="Arrays" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Hewlett Packard Enterprise Development LP.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>