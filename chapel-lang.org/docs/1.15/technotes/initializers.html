

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Initializers &mdash; Chapel Documentation 1.15</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Chapel Documentation 1.15" href="../index.html"/>
        <link rel="up" title="Technical Notes" href="index.html"/>
        <link rel="next" title="Exporting Chapel as a Library" href="libraries.html"/>
        <link rel="prev" title="Forwarding Methods Calls" href="forwarding.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Chapel Documentation
          

          
          </a>

          
            
            
          

          
<?php   // Variables given by sphinx 
   $chplTitle = "1.15";   $pagename = "./technotes/initializers";   include "../versionButton.php";   ?>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Technical Notes</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="allocators.html">Chapel's Use of Allocators</a></li>
<li class="toctree-l2"><a class="reference internal" href="atomics.html">Runtime Support for Atomics</a></li>
<li class="toctree-l2"><a class="reference internal" href="auxIO.html">Auxiliary I/O Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="chpl-ipe.html">Interactive Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="dsi.html">Domain Map Standard Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="errorHandling.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="extern.html">C Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="firstClassFns.html">First-class Functions in Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="forwarding.html">Forwarding Methods Calls</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Initializers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#stability">Stability</a></li>
<li class="toctree-l3"><a class="reference internal" href="#status">Status</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="libraries.html">Exporting Chapel as a Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="llvm.html">LLVM Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="local.html">The 'local' keyword</a></li>
<li class="toctree-l2"><a class="reference internal" href="localeModels.html">Locale Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="main.html">Support for main() Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="module_search.html">Module Search Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduceIntents.html">Reduce Intents</a></li>
<li class="toctree-l2"><a class="reference internal" href="sets.html">Associative Set Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="subquery.html">Querying a Local Subdomain</a></li>
<li class="toctree-l2"><a class="reference internal" href="voidVariables.html">Void Variables and Fields</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../builtins/index.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/standard.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/archivedSpecs.html">Archived Language Specifications</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Chapel Documentation 1.15</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Technical Notes</a> &raquo;</li>
      
    <li>Initializers</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/technotes/initializers.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="initializers">
<span id="readme-initializers"></span><h1>Initializers<a class="headerlink" href="#initializers" title="Permalink to this headline">¶</a></h1>
<p>The Chapel team is implementing a new approach to user-defined
intialization of variables with record type or instances of class
type.  This approach relies on methods known as initializers rather
than the original methods known as constructors.</p>
<p>A discussion of the current design and rationale is provided in
<a class="reference external" href="https://github.com/chapel-lang/chapel/blob/master/doc/rst/developer/chips/10.rst">CHIP 10</a>.</p>
<p>Release Chapel 1.15.0 provides a strong preview implementation of this
new feature. This initial implementation is not of production quality
and has not been heavily tested, but the basic features are working
and it is believed that adventurous developers will have success using
init methods in new code.</p>
<p>It is anticipated that the implementation will continue to advance
steadily after this release and that many aspects of the internal
implementation of Chapel will transition from constructor methods to
initializer methods during this release.</p>
<div class="section" id="stability">
<h2>Stability<a class="headerlink" href="#stability" title="Permalink to this headline">¶</a></h2>
<p>The functionality of an initializer method has four major aspects</p>
<blockquote>
<div><ul class="simple">
<li>user-defined code that runs in phase 2</li>
<li>user-defined code that runs in phase 1</li>
<li>compiler generated code that runs in phase 1</li>
<li>the generation of effective user-facing diagnostic messages</li>
</ul>
</div></blockquote>
<p>in approximate order of robustness and maturity.</p>
<p>The user-defined code that executes in phase 2 of an initializer is
comparable to the user-defined code in any method and is likely to
behave in the expected way.</p>
<p>The user-defined code that executes in phase 1 of an initializer has
many of the same properties and is also expected to behave well.
However there are more restrictions on user-defined code for phase 1
and the compiler may fail to apply these restrictions correctly.  The
most likely error is that the compiler will accept phase 1 code that
it should reject but it is possible that there will be situations in
which valid code is rejected.</p>
<p>The design for initializer methods attempts to define predictable
default behaviors within phase 1 and then rely on the compiler to
insert these defaults when appropriate.  The intent is to reduce the
amount of code that the type designer is responsible for.  This
includes the generation of code using field-level default
declarations.  Defining and implementing these default behaviors
relies on relatively less mature code within the compiler.</p>
<p>We believe that initializer methods are ready for use in application code
but we also expect that the implementation will mature significantly
during the 1.15 release.  We encourage their use but recognize that they
may prove to be less robust than we would like at the start of the release.
If you do choose to experiment with this feature then please do not
hesitate to seek help, report bugs, or offer suggestions.</p>
<p>Generic records and classes, i.e. records or classes in which the
definition of the type of one or more fields is parameterized are less
well developed than records and classes for which the type of every
fields can be inferred directly from the type declaration.</p>
</div>
<div class="section" id="status">
<h2>Status<a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h2>
<p>As of the 1.15.0 release, support for initializers includes the following:</p>
<ul class="simple">
<li>Methods named &quot;init&quot; on a type are utilized during the creation of an
instance of that type.</li>
<li>An error message is generated if both a constructor and an initializer is
defined on a type.</li>
<li>User-defined initializers whose body consists of only Phase 2 statements
appear to be fully supported</li>
<li>User-defined initializers with Phase 1 statements that explicitly initialize
all of the fields appear to be well supported<ul>
<li>Some errors remain with omitted field initialization in Phase 1, notably
with utilizing <code class="docutils literal"><span class="pre">param</span></code> fields in the omitted initialization of another
field, and with utilizing some record fields.</li>
</ul>
</li>
<li>Many checks against Phase 1 and Phase 2 rules are implemented, including:<ul>
<li>Forbidding the update of <code class="docutils literal"><span class="pre">const</span></code> fields during Phase 2</li>
<li>Forbidding the initialization of fields in parallel statements during
Phase 1</li>
<li>Forbidding the initialization of fields in loops during Phase 1</li>
<li>Forbidding <code class="docutils literal"><span class="pre">super.init()</span></code> and <code class="docutils literal"><span class="pre">this.init()</span></code> calls in parallel
statements</li>
<li>Forbidding <code class="docutils literal"><span class="pre">super.init()</span></code> and <code class="docutils literal"><span class="pre">this.init()</span></code> calls in loops</li>
<li>Forbidding access to a field prior to its initialization in Phase 1</li>
<li>Forbidding the initialization of fields prior to <code class="docutils literal"><span class="pre">this.init()</span></code> calls</li>
<li>Limiting the access of parent fields during Phase 1 of initialization</li>
</ul>
</li>
<li>Support for initializers on generic classes when instances infer their type
from the result of a <code class="docutils literal"><span class="pre">new</span></code> call or another instance.<ul>
<li>As a result, generic fields no longer require an argument sharing their
name in the initializer argument list.</li>
</ul>
</li>
<li>Support for copy initializers</li>
<li>Support for deinitializers, as a replacement of destructors.<ul>
<li>Library types were converted to use deinitializers.</li>
</ul>
</li>
</ul>
<p>Remaining todo items include:</p>
<ul class="simple">
<li>Support for compiler generated initializers</li>
<li>Improve the error message for out of order field initialization during
Phase 1</li>
<li>Forbid the utilization of methods on the type during Phase 1 of
initialization, as well as the use of <code class="docutils literal"><span class="pre">this</span></code> as an argument to a function.</li>
<li>Full support for <code class="docutils literal"><span class="pre">param</span></code> conditional situations</li>
<li>Resolve an issue with secondary initializers</li>
<li>Support for instance declarations of generic instantiations, i.e. <code class="docutils literal"><span class="pre">var</span> <span class="pre">x:</span>
<span class="pre">Foo(t);</span></code></li>
<li>Resolve an issue with generic initializers and records (relates to records
being passed by <code class="docutils literal"><span class="pre">ref</span></code> to the initializer method)</li>
<li>Convert library types to utilize initializers instead of constructors</li>
<li>Support <code class="docutils literal"><span class="pre">noinit</span></code></li>
</ul>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="libraries.html" class="btn btn-neutral float-right" title="Exporting Chapel as a Library" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="forwarding.html" class="btn btn-neutral" title="Forwarding Methods Calls" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Cray Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.15.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 



</body>
</html>