

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Chapel Launchers &mdash; Chapel Documentation 1.13</title>
  

  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Chapel Documentation 1.13" href="../index.html"/>
        <link rel="up" title="Using Chapel" href="index.html"/>
        <link rel="next" title="Chapel Tasks" href="tasks.html"/>
        <link rel="prev" title="Multilocale Chapel Execution" href="multilocale.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Chapel Documentation
          

          
          </a>

          
            
            
          

          
<?php   // Variables given by sphinx 
   $chplTitle = "1.13";   $pagename = "./usingchapel/launcher";   include "../versionButton.php";   ?>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Using Chapel</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="prereqs.html">Chapel Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="chplenv.html">Setting up Your Environment for Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="building.html">Building Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="compiling.html">Compiling Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="man.html">Chapel Man Page</a></li>
<li class="toctree-l2"><a class="reference internal" href="executing.html">Executing Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="multilocale.html">Multilocale Chapel Execution</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Chapel Launchers</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#forwarding-environment-variables">Forwarding Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#real-binary-suffix-for-execution">_real binary suffix for execution</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bypassing-the-launcher">Bypassing the launcher</a></li>
<li class="toctree-l3"><a class="reference internal" href="#slurm-notes">SLURM notes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#additional-launchers">Additional launchers</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="tasks.html">Chapel Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="debugging.html">Debugging Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="bugs.html">Reporting Chapel Bugs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools/index.html">Tools</a></li>
</ul>
<p class="caption"><span class="caption-text">Writing Chapel Programs</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../language/spec.html">Language Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/builtins.html">Built-in Types and Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/modules.html">Standard Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules/layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../language/evolution.html">Chapel Evolution</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">Chapel Documentation 1.13</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">Using Chapel</a> &raquo;</li>
      
    <li>Chapel Launchers</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/usingchapel/launcher.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="chapel-launchers">
<span id="readme-launcher"></span><h1>Chapel Launchers<a class="headerlink" href="#chapel-launchers" title="Permalink to this headline">¶</a></h1>
<p>When compiling Chapel programs for multiple locales, a launcher binary
is typically created that will execute the appropriate command(s) to
get your program started. For example, when compiling for multiple
locales, typically two binaries will be generated by the compiler
(e.g., a.out and a.out_real). The first binary contains code to get
your program up and running on multiple locales while the second
contains your actual program code.</p>
<p>The goals of the launcher binary are:</p>
<ol class="arabic simple">
<li>to wrap details of job startup in a portable way so that new users
can quickly get Chapel programs up and running on an unfamiliar
platform.</li>
<li>to perform command-line parsing and error checking prior to
waiting in a queue or firing off a parallel job in order to save
time and resources related to simple errors/typos in the command
line.</li>
<li>to preserve Chapel's global-view programming model by permitting
the user to run their program using a single binary (corresponding
to the single logical task that executes main()) without getting
bogged down in questions of numbers of nodes, numbers of cores per
node, numbers of program instances to start up, etc.</li>
<li>if necessary, to coordinate runtime functional activity, such as
I/O.</li>
</ol>
<p>Executing a Chapel program using the verbose (<code class="docutils literal"><span class="pre">-v</span></code>) flag will typically
print out the command(s) used to launch the program.</p>
<p>Executing using the help (<code class="docutils literal"><span class="pre">-h</span></code>/<code class="docutils literal"><span class="pre">--help</span></code>) flag will typically print out
any launcher-specific options in addition to the normal help message for
the program itself.</p>
<p>Currently supported launchers include:</p>
<table border="1" class="docutils">
<colgroup>
<col width="27%" />
<col width="73%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Launcher Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>amudprun</td>
<td>GASNet launcher for programs running over UDP</td>
</tr>
<tr class="row-odd"><td>aprun</td>
<td>Cray application launcher using aprun</td>
</tr>
<tr class="row-even"><td>gasnetrun_ibv</td>
<td>GASNet launcher for programs running over Infiniband</td>
</tr>
<tr class="row-odd"><td>gasnetrun_mpi</td>
<td>GASNet launcher for programs using the MPI conduit</td>
</tr>
<tr class="row-even"><td>lsf-gasnetrun_ibv</td>
<td>GASNet launcher using LSF (bsub) over Infiniband</td>
</tr>
<tr class="row-odd"><td>pbs-aprun</td>
<td>Cray application launcher using PBS (qsub) + aprun</td>
</tr>
<tr class="row-even"><td>pbs-gasnetrun_ibv</td>
<td>GASNet launcher using PBS (qsub) over Infiniband</td>
</tr>
<tr class="row-odd"><td>slurm-gasnetrun_ibv</td>
<td>GASNet launcher using SLURM over Infiniband</td>
</tr>
<tr class="row-even"><td>slurm-srun</td>
<td>native SLURM launcher</td>
</tr>
<tr class="row-odd"><td>none</td>
<td>do not use a launcher</td>
</tr>
</tbody>
</table>
<p>A specific launcher can be explicitly requested by setting the
<code class="docutils literal"><span class="pre">CHPL_LAUNCHER</span></code> environment variable. If left unset, a default is picked as
follows:</p>
<ul>
<li><p class="first">if <code class="docutils literal"><span class="pre">CHPL_PLATFORM</span></code> is cray-xc, cray-xe, cray-xk, or cray-xt:</p>
<table border="1" class="docutils">
<colgroup>
<col width="49%" />
<col width="51%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">If</th>
<th class="head">CHPL_LAUNCHER</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>both aprun and srun in user's path</td>
<td>none</td>
</tr>
<tr class="row-odd"><td>aprun in user's path</td>
<td>aprun</td>
</tr>
<tr class="row-even"><td>srun in user's path</td>
<td>slurm-srun</td>
</tr>
<tr class="row-odd"><td>otherwise</td>
<td>none</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">otherwise, if <code class="docutils literal"><span class="pre">CHPL_COMM</span></code> is gasnet:</p>
<table border="1" class="docutils">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">If</th>
<th class="head">CHPL_LAUNCHER</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CHPL_COMM_SUBSTRATE=ibv</td>
<td>gasnetrun_ibv</td>
</tr>
<tr class="row-odd"><td>CHPL_COMM_SUBSTRATE=mpi</td>
<td>gasnetrun_mpi</td>
</tr>
<tr class="row-even"><td>CHPL_COMM_SUBSTRATE=mxm</td>
<td>gasnetrun_ibv</td>
</tr>
<tr class="row-odd"><td>CHPL_COMM_SUBSTRATE=udp</td>
<td>amudprun</td>
</tr>
<tr class="row-even"><td>otherwise</td>
<td>none</td>
</tr>
</tbody>
</table>
</li>
<li><p class="first">otherwise <code class="docutils literal"><span class="pre">CHPL_LAUNCHER</span></code> is set to none</p>
</li>
</ul>
<p>If the launcher binary does not work for your system (due to an
installation-specific configuration, e.g.), you can often use the <code class="docutils literal"><span class="pre">-v</span></code>
flag to capture the commands that the launcher executes on your behalf
and customize them for your needs.</p>
<div class="section" id="forwarding-environment-variables">
<h2>Forwarding Environment Variables<a class="headerlink" href="#forwarding-environment-variables" title="Permalink to this headline">¶</a></h2>
<p>Chapel launchers generally arrange for environment variables to be
forwarded to worker processes. However, this strategy is not always
reliable. The remote system may ovrride some environment variables, and
some launchers might not correctly forward all environment variables.  In
particular, the amudprun launcher will not forward environment variables
containing backticks (`).</p>
</div>
<div class="section" id="real-binary-suffix-for-execution">
<h2>_real binary suffix for execution<a class="headerlink" href="#real-binary-suffix-for-execution" title="Permalink to this headline">¶</a></h2>
<p>In order to support profiling tools that produce new binaries for the
launcher to execute, the suffix of the real binary executed by the
launcher may be changed with the <code class="docutils literal"><span class="pre">CHPL_LAUNCHER_SUFFIX</span></code> environment
variable. If this variable is unset, the suffix defaults to &quot;_real&quot;,
matching the compiler's output.</p>
</div>
<div class="section" id="bypassing-the-launcher">
<h2>Bypassing the launcher<a class="headerlink" href="#bypassing-the-launcher" title="Permalink to this headline">¶</a></h2>
<p>If the Chapel launcher capability fails you completely, set
<code class="docutils literal"><span class="pre">CHPL_LAUNCHER</span></code> to none, recompile, and execute the a.out binary
according to the following rules using tools and queueing mechanisms
appropriate for your system:</p>
<ul class="simple">
<li>on most systems, the number of locales should be equal to the number
of nodes on which you execute which should be equal to the number of
copies of a.out (or a.out_real using a launcher) that you are
running.</li>
<li>some queueing systems require you to specify the number of cores to
use per node. For best results, you will typically want to use all
of them. All intra-node parallelism is typically implemented using
Chapel's threading layer (e.g., pthreads), so extra copies of the
binary are not required per core.</li>
</ul>
</div>
<div class="section" id="slurm-notes">
<h2>SLURM notes<a class="headerlink" href="#slurm-notes" title="Permalink to this headline">¶</a></h2>
<p>Prerequisites:</p>
<blockquote>
<div><p>To use native SLURM, set:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CHPL_LAUNCHER</span><span class="o">=</span>slurm-srun
</pre></div>
</div>
<p>This will happen automatically if srun is found in your path, but
not when both srun and aprun are found in your path.</p>
<p>To use SLURM using GASNet over Infiniband, set:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CHPL_LAUNCHER</span><span class="o">=</span>slurm-gasnetrun_ibv
<span class="nb">export</span> <span class="nv">CHPL_COMM</span><span class="o">=</span>gasnet
<span class="nb">export</span> <span class="nv">CHPL_COMM_SUBSTRATE</span><span class="o">=</span>ibv
</pre></div>
</div>
<p>To have GASNet use mpirun to launch your program, set:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">GASNET_IBV_SPAWNER</span><span class="o">=</span>mpi
</pre></div>
</div>
<p>At this point, rebuild your Chapel runtime ('make' from <code class="docutils literal"><span class="pre">$CHPL_HOME</span></code>),
and compile your program.</p>
</div></blockquote>
<p>Settings:</p>
<blockquote>
<div><p>Before running, you will need to set the amount of time to request
from SLURM. For example, the following requests 15 minutes:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CHPL_LAUNCHER_WALLTIME</span><span class="o">=</span>00:15:00
</pre></div>
</div>
<p>If needed, you can request a specific node feature from SLURM by putting
it in the <code class="docutils literal"><span class="pre">CHPL_LAUNCHER_CONSTRAINT</span></code> environment variable. For example,
to use nodes with the 'cal' feature (as defined in the slurm.conf
file), set:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">CHPL_LAUNCHER_CONSTRAINT</span><span class="o">=</span>cal
</pre></div>
</div>
<p>If this environment variable is undefined, SLURM may use any node in
the computer.</p>
<p>If the environment variable <code class="docutils literal"><span class="pre">CHPL_LAUNCHER_USE_SBATCH</span></code> is defined then
sbatch is used to launch the job to the queue system, rather than
running it interactively as usual. In this mode, the output will be
written by default to a file called &lt;executableName&gt;.&lt;jobID&gt;.out. The
environment variable <code class="docutils literal"><span class="pre">CHPL_LAUNCHER_SLURM_OUTPUT_FILENAME</span></code> can be used
to specify a different filename for the output.</p>
<p>Other SLURM variables will have an impact; for example, the SLURM
partition can be set to 'debug' with the command:</p>
<div class="highlight-sh"><div class="highlight"><pre><span></span><span class="nb">export</span> <span class="nv">SLURM_PARTITION</span><span class="o">=</span>debug
</pre></div>
</div>
</div></blockquote>
</div>
<div class="section" id="additional-launchers">
<h2>Additional launchers<a class="headerlink" href="#additional-launchers" title="Permalink to this headline">¶</a></h2>
<p>In addition to the launchers listed above there are several others that
are not actively maintained but may still work.</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Launcher Name</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>loadleveler</td>
<td>launch using IBM loadleveler (still needs refining)</td>
</tr>
<tr class="row-odd"><td>marenostrum</td>
<td>launch using MareNostrum's mnsubmit script</td>
</tr>
<tr class="row-even"><td>mpirun</td>
<td>launch using mpirun (no mpi comm currently)</td>
</tr>
</tbody>
</table>
<p>These launchers are the default for the following configurations:</p>
<table border="1" class="docutils">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">If</th>
<th class="head">CHPL_LAUNCHER</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>CHPL_PLATFORM=marenostrum</td>
<td>marenostrum</td>
</tr>
</tbody>
</table>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="tasks.html" class="btn btn-neutral float-right" title="Chapel Tasks" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="multilocale.html" class="btn btn-neutral" title="Multilocale Chapel Execution" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Cray Inc.

    </p>
  </div> 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.13.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 

</body>
</html>
