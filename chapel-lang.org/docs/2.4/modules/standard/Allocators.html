<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Allocators &mdash; Chapel Documentation 2.4</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/style.css?v=70f659a1" />

  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=4d935f96"></script>
        <script src="../../_static/doctools.js?v=888ff710"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CTypes" href="CTypes.html" />
    <link rel="prev" title="GPU" href="GPU.html" />
   
  

</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

<a href="../../index.html" class="icon icon-home"> Chapel Documentation

<!-- display version if button won't be rendered -->
<?php if (false) { ?>
<br>2.4
<?php } ?>

</a>

<?php
// Variables given by sphinx
$chplTitle = "2.4";
$pagename = "modules/standard/Allocators";
include "../..//versionButton.php";
?>


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
  
              <p class="caption" role="heading"><span class="caption-text">Compiling and Running Chapel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/QUICKSTART.html">Quickstart Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../developer/index.html">Docs for Contributors</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Writing Chapel Programs</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../language/reference.html">Quick Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../examples/index.html">Hello World Variants</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../primers/index.html">Primers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/spec/index.html">Language Specification</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../standard.html">Standard Modules</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../standard.html#automatic-modules">Automatic Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#algorithms">Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#data-structures">Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#diagnostics">Diagnostics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#files-io">Files/IO</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#language-support">Language Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#math-numerical">Math/Numerical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#parallelism-distributed-computing">Parallelism/Distributed Computing</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../standard.html#system-interoperability">System/Interoperability</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Allocators</a></li>
<li class="toctree-l3"><a class="reference internal" href="CTypes.html">CTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="OS.html">OS</a></li>
<li class="toctree-l3"><a class="reference internal" href="Subprocess.html">Subprocess</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../standard.html#utilities">Utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../packages.html">Package Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../layoutdist.html">Standard Layouts and Distributions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mason-packages/index.html">Mason Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../users-guide/index.html">Chapel Users Guide (WIP)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Language History</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../language/evolution.html">Chapel Evolution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../language/archivedSpecs.html">Documentation Archives</a></li>
</ul>

  <p class="caption" role="heading"><span class="caption-text">Indexes</span></p>
  <ul>
    <li class="toctree-11"><a class="reference internal" href="../../chpl-modindex.html">Chapel Module Index</a></li>
    <li class="toctree-11"><a class="reference internal" href="../../genindex.html">Complete Docs Index</a></li>
  </ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Chapel Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../standard.html">Standard Modules</a></li>
      <li class="breadcrumb-item active">Allocators</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/modules/standard/Allocators.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="allocators">
<span id="module-Allocators"></span><h1>Allocators<a class="headerlink" href="#allocators" title="Link to this heading">Â¶</a></h1>
<p><strong>Usage</strong></p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">use</span> <span class="nx">Allocators</span><span class="p">;</span>
</pre></div>
</div>
<p>or</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">import</span> <span class="nx">Allocators</span><span class="p">;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The Allocators module is under development and does not have a stable interface yet</p>
</div>
<p>Provides custom allocators for Chapel objects on the heap.</p>
<p>This module provides an interface to customize how Chapel objects are
allocated on the heap. This is opted into by changing calls to
<code class="docutils literal notranslate"><span class="pre">new</span></code>/<code class="docutils literal notranslate"><span class="pre">delete</span></code> into <a class="reference internal" href="#Allocators.newWithAllocator" title="Allocators.newWithAllocator"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">newWithAllocator</span></code></a>/<a class="reference internal" href="#Allocators.deleteWithAllocator" title="Allocators.deleteWithAllocator"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deleteWithAllocator</span></code></a>. This
new functions allow Chapel code to customize how objects are allocated and
deallocated.</p>
<p>For example, the following code demonstrates how the <a class="reference internal" href="#Allocators.mallocWrapper" title="Allocators.mallocWrapper"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">mallocWrapper</span></code></a>
allocator can be used to allocate a Chapel class.</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">x</span><span class="p">:</span> <span class="kt">int</span><span class="p">;</span> <span class="p">}</span>
<span class="kd">var</span> <span class="nx">alloc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">mallocWrapper</span><span class="p">(</span><span class="mi">1024</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">newWithAllocator</span><span class="p">(</span><span class="nx">alloc</span><span class="p">,</span> <span class="k">unmanaged</span> <span class="nx">MyClass</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="nx">writeln</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="nx">deleteWithAllocator</span><span class="p">(</span><span class="nx">alloc</span><span class="p">,</span> <span class="nx">x</span><span class="p">);</span>
</pre></div>
</div>
<p>Custom allocators can be defined as classes or records that implement the
<a class="reference internal" href="#Allocators.allocator" title="Allocators.allocator"><code class="xref chpl chpl-interface docutils literal notranslate"><span class="pre">allocator</span></code></a> interface. The interface has two methods:
<a class="reference internal" href="#Allocators.allocator.Self.allocate" title="Allocators.allocator.Self.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a> and <a class="reference internal" href="#Allocators.allocator.Self.deallocate" title="Allocators.allocator.Self.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a>. The
<a class="reference internal" href="#Allocators.allocator.Self.allocate" title="Allocators.allocator.Self.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a> method accepts an integer <code class="docutils literal notranslate"><span class="pre">n</span></code> and returns
a <a class="reference internal" href="CTypes.html#CTypes.c_ptr" title="CTypes.c_ptr"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">c_ptr</span></code></a> to the allocated memory. The
<a class="reference internal" href="#Allocators.allocator.Self.deallocate" title="Allocators.allocator.Self.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a> method accepts a <a class="reference internal" href="CTypes.html#CTypes.c_ptr" title="CTypes.c_ptr"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">c_ptr</span></code></a> to
the allocated memory. Allocators are free to implement their own memory
management strategies.</p>
<dl class="simple">
<dt>Limitations:</dt><dd><ul class="simple">
<li><p>The <a class="reference internal" href="#Allocators.newWithAllocator" title="Allocators.newWithAllocator"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">newWithAllocator</span></code></a> and <a class="reference internal" href="#Allocators.deleteWithAllocator" title="Allocators.deleteWithAllocator"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deleteWithAllocator</span></code></a> procedures
are meant to be stand-ins pending a more elegant syntax to use custom
allocators.</p></li>
<li><p>This module currently only supports allocating Chapel classes. In the
future we hope to support other heap objects like arrays.</p></li>
<li><p>Allocating managed (<a class="reference internal" href="../../language/spec/classes.html#OwnedObject.owned" title="OwnedObject.owned"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">owned</span></code></a>/<a class="reference internal" href="../../language/spec/classes.html#SharedObject.shared" title="SharedObject.shared"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">shared</span></code></a>)
Chapel classes are not supported, only <code class="docutils literal notranslate"><span class="pre">unmanaged</span></code> classes are supported.</p></li>
</ul>
</dd>
</dl>
<dl class="chpl interface">
<dt class="sig sig-object chpl" id="Allocators.allocator">
<em class="property"><span class="pre">interface</span> </em><span class="sig-name descname"><span class="pre">allocator</span></span><a class="headerlink" href="#Allocators.allocator" title="Link to this definition">Â¶</a></dt>
<dd><p>All allocators must implement this interface. The interface has two
methods: <a class="reference internal" href="#Allocators.allocator.Self.allocate" title="Allocators.allocator.Self.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a> and
<a class="reference internal" href="#Allocators.allocator.Self.deallocate" title="Allocators.allocator.Self.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a>. The <a class="reference internal" href="#Allocators.allocator.Self.allocate" title="Allocators.allocator.Self.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a>
method accepts an integer size and returns a pointer to the allocated
memory. The <a class="reference internal" href="#Allocators.allocator.Self.deallocate" title="Allocators.allocator.Self.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a> method accepts a pointer
to the allocated memory.</p>
<p>Allocators may either be classes or records.</p>
<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.allocator.Self.allocate">
<em class="property"><span class="pre">proc</span> <span class="pre">ref</span> </em><span class="sig-prename descclassname"><span class="pre">Self.</span></span><span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n:</span> <span class="pre">int</span></em><span class="sig-paren">)</span><em class="property"> <span class="pre">:</span> <span class="pre">c_ptr(void)</span></em><a class="headerlink" href="#Allocators.allocator.Self.allocate" title="Link to this definition">Â¶</a></dt>
<dd></dd></dl>

<p>Allocate memory for <code class="docutils literal notranslate"><span class="pre">n</span></code> bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> â The number of bytes to allocate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">c_ptr(void)</span></code> to the allocated memory.</p>
</dd>
</dl>
<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.allocator.Self.deallocate">
<em class="property"><span class="pre">proc</span> <span class="pre">ref</span> </em><span class="sig-prename descclassname"><span class="pre">Self.</span></span><span class="sig-name descname"><span class="pre">deallocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">p:</span> <span class="pre">c_ptr(void)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.allocator.Self.deallocate" title="Link to this definition">Â¶</a></dt>
<dd></dd></dl>

<p>Deallocate memory at <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> â The pointer to the allocated memory.</p>
</dd>
</dl>
</dd></dl>

<dl class="chpl function">
<dt class="sig sig-object chpl" id="Allocators.newWithAllocator">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">newWithAllocator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">alloc:</span> <span class="pre">allocator</span></em>, <em class="sig-param"><span class="pre">type</span> <span class="pre">T</span></em>, <em class="sig-param"><span class="pre">args</span> <span class="pre">...</span></em><span class="sig-paren">)</span><em class="property"> <span class="pre">:</span> <span class="pre">T</span></em><a class="headerlink" href="#Allocators.newWithAllocator" title="Link to this definition">Â¶</a></dt>
<dd><p>Allocate a new unmanaged class with type <code class="docutils literal notranslate"><span class="pre">T</span></code> by invoking the
<a class="reference internal" href="#Allocators.allocator.Self.allocate" title="Allocators.allocator.Self.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a> method of the given <code class="docutils literal notranslate"><span class="pre">alloc</span></code>. This is a
drop-in replacement for <code class="docutils literal notranslate"><span class="pre">new</span></code>.</p>
<p>Example:</p>
<div class="highlight-chapel notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">MyClass</span> <span class="p">{</span> <span class="kd">var</span> <span class="nx">x</span><span class="p">:</span> <span class="kt">int</span><span class="p">;</span> <span class="p">}</span>
<span class="kd">var</span> <span class="nx">allocator</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">bumpPtrMemPool</span><span class="p">(</span><span class="mi">1024</span><span class="p">);</span>
<span class="c1">// The following two lines are equivalent, but the second one uses the allocator</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="k">new</span> <span class="k">unmanaged</span> <span class="nx">MyClass</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">x</span> <span class="o">=</span> <span class="nx">newWithAllocator</span><span class="p">(</span><span class="nx">allocator</span><span class="p">,</span> <span class="k">unmanaged</span> <span class="nx">MyClass</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Named argument passing will not work with this function currently.</p>
</div>
</dd></dl>

<dl class="chpl function">
<dt class="sig sig-object chpl" id="Allocators.deleteWithAllocator">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">deleteWithAllocator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">alloc:</span> <span class="pre">allocator</span></em>, <em class="sig-param"><span class="pre">objects</span> <span class="pre">...</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.deleteWithAllocator" title="Link to this definition">Â¶</a></dt>
<dd><p>Delete the <code class="docutils literal notranslate"><span class="pre">objects</span></code> by invoking the <a class="reference internal" href="#Allocators.allocator.Self.deallocate" title="Allocators.allocator.Self.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a>
method of the given <a class="reference internal" href="#Allocators.allocator" title="Allocators.allocator"><code class="xref chpl chpl-interface docutils literal notranslate"><span class="pre">allocator</span></code></a>. This is a drop-in replacement
for <code class="docutils literal notranslate"><span class="pre">delete</span></code>.</p>
</dd></dl>

<dl class="chpl class">
<dt class="sig sig-object chpl" id="Allocators.mallocWrapper">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">mallocWrapper</span></span><em class="property"> <span class="pre">:</span> <span class="pre">allocator</span></em><a class="headerlink" href="#Allocators.mallocWrapper" title="Link to this definition">Â¶</a></dt>
<dd><p>A simple allocator that acts as a wrapper around <a class="reference internal" href="CTypes.html#CTypes.allocate" title="CTypes.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">CTypes.allocate</span></code></a>
and <a class="reference internal" href="CTypes.html#CTypes.deallocate" title="CTypes.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">CTypes.deallocate</span></code></a>.</p>
<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.mallocWrapper.allocate">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n:</span> <span class="pre">int</span></em><span class="sig-paren">)</span><em class="property"> <span class="pre">:</span> <span class="pre">c_ptr(void)</span></em><a class="headerlink" href="#Allocators.mallocWrapper.allocate" title="Link to this definition">Â¶</a></dt>
<dd><p>Allocate memory for <code class="docutils literal notranslate"><span class="pre">n</span></code> bytes.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> â The number of bytes to allocate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">c_ptr(void)</span></code> to the allocated memory.</p>
</dd>
</dl>
</dd></dl>

<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.mallocWrapper.deallocate">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">deallocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">p:</span> <span class="pre">c_ptr(void)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.mallocWrapper.deallocate" title="Link to this definition">Â¶</a></dt>
<dd><p>Deallocate memory at <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> â The pointer to the allocated memory.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="chpl class">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool">
<em class="property"><span class="pre">class</span> </em><span class="sig-name descname"><span class="pre">bumpPtrMemPool</span></span><em class="property"> <span class="pre">:</span> <span class="pre">allocator</span></em><a class="headerlink" href="#Allocators.bumpPtrMemPool" title="Link to this definition">Â¶</a></dt>
<dd><p>The is a simple bump pointer allocator that is useful for allocating many
small objects.</p>
<p>This allocator makes a single memory allocation in a contiguous block,
calls to <a class="reference internal" href="#Allocators.bumpPtrMemPool.allocate" title="Allocators.bumpPtrMemPool.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a> will return the next available
address. This allocator is not thread-safe by default, but can be made
thread-safe by setting the <a class="reference internal" href="#Allocators.bumpPtrMemPool.parSafe" title="Allocators.bumpPtrMemPool.parSafe"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">parSafe</span></code></a> parameter to
<code class="docutils literal notranslate"><span class="pre">true</span></code>. By default, all memory allocated by <a class="reference internal" href="#Allocators.bumpPtrMemPool" title="Allocators.bumpPtrMemPool"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">bumpPtrMemPool</span></code></a> is aligned
to 16 bytes. This can be changed by setting the
<a class="reference internal" href="#Allocators.bumpPtrMemPool.alignment" title="Allocators.bumpPtrMemPool.alignment"><code class="xref chpl chpl-param docutils literal notranslate"><span class="pre">alignment</span></code></a> parameter. An alignment of 0 will disable
alignment.</p>
<p>The <a class="reference internal" href="#Allocators.bumpPtrMemPool" title="Allocators.bumpPtrMemPool"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">bumpPtrMemPool</span></code></a> is initialized with a fixed size and allocates
memory from that fixed size. Attempting to allocate more memory than the
fixed size will result in an error. With checks enabled the program will
halt, otherwise memory errors will occur.</p>
<p>All memory allocated by <a class="reference internal" href="#Allocators.bumpPtrMemPool" title="Allocators.bumpPtrMemPool"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">bumpPtrMemPool</span></code></a> is deallocated when the
<a class="reference internal" href="#Allocators.bumpPtrMemPool" title="Allocators.bumpPtrMemPool"><code class="xref chpl chpl-type docutils literal notranslate"><span class="pre">bumpPtrMemPool</span></code></a> instance is destroyed. The
<a class="reference internal" href="#Allocators.bumpPtrMemPool.deallocate" title="Allocators.bumpPtrMemPool.deallocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">deallocate</span></code></a> method is a no-op.</p>
<dl class="chpl attribute">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.parSafe">
<em class="property"><span class="pre">param</span> </em><span class="sig-name descname"><span class="pre">parSafe</span></span><em class="property"> <span class="pre">:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">false</span></em><a class="headerlink" href="#Allocators.bumpPtrMemPool.parSafe" title="Link to this definition">Â¶</a></dt>
<dd><p>Whether or not this allocator is thread-safe. if <code class="docutils literal notranslate"><span class="pre">true</span></code>, this allocator
will use a lock to ensure that only one thread can allocate memory at a
time.</p>
</dd></dl>

<dl class="chpl attribute">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.alignment">
<em class="property"><span class="pre">param</span> </em><span class="sig-name descname"><span class="pre">alignment</span></span><em class="property"> <span class="pre">:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">16</span></em><a class="headerlink" href="#Allocators.bumpPtrMemPool.alignment" title="Link to this definition">Â¶</a></dt>
<dd><p>The alignment of memory allocated by this allocator. If <code class="docutils literal notranslate"><span class="pre">alignment</span></code> is
greater than 0, the pointers returned by <a class="reference internal" href="#Allocators.bumpPtrMemPool.allocate" title="Allocators.bumpPtrMemPool.allocate"><code class="xref chpl chpl-proc docutils literal notranslate"><span class="pre">allocate</span></code></a>
will be aligned to that alignment. <code class="docutils literal notranslate"><span class="pre">alignment</span></code> must be a power of 2.</p>
</dd></dl>

<dl class="chpl attribute">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.size">
<em class="property"><span class="pre">var</span> </em><span class="sig-name descname"><span class="pre">size</span></span><em class="property"> <span class="pre">:</span> <span class="pre">int(64)</span></em><a class="headerlink" href="#Allocators.bumpPtrMemPool.size" title="Link to this definition">Â¶</a></dt>
<dd><p>The size of the memory block allocated by this allocator.</p>
</dd></dl>

<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.init">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">size:</span> <span class="pre">int(64)</span></em>, <em class="sig-param"><span class="pre">param</span> <span class="pre">parSafe:</span> <span class="pre">bool</span> <span class="pre">=</span> <span class="pre">false</span></em>, <em class="sig-param"><span class="pre">param</span> <span class="pre">alignment:</span> <span class="pre">int</span> <span class="pre">=</span> <span class="pre">16</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.bumpPtrMemPool.init" title="Link to this definition">Â¶</a></dt>
<dd><p>Initializes the allocator with a fixed size. The allocator will allocate
memory from this fixed size.</p>
<p>Memory is allocated eagerly, so the entire size is allocated when the
allocator is created.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>size</strong> â The size of the memory block allocated by this allocator.</p></li>
<li><p><strong>parSafe</strong> â Whether or not this allocator is thread-safe.</p></li>
<li><p><strong>alignment</strong> â The alignment of memory allocated by this allocator.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.deinit">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">deinit</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.bumpPtrMemPool.deinit" title="Link to this definition">Â¶</a></dt>
<dd><p>Deallocates all memory owned by this allocator. Attempting to use an
object allocated by this allocator after calling this method will result
in a use-after-free error.</p>
</dd></dl>

<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.allocate">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">allocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">n:</span> <span class="pre">int</span></em><span class="sig-paren">)</span><em class="property"> <span class="pre">:</span> <span class="pre">c_ptr(void)</span></em><a class="headerlink" href="#Allocators.bumpPtrMemPool.allocate" title="Link to this definition">Â¶</a></dt>
<dd><p>Allocate memory for <code class="docutils literal notranslate"><span class="pre">n</span></code> bytes. If <a class="reference internal" href="#Allocators.bumpPtrMemPool.alignment" title="Allocators.bumpPtrMemPool.alignment"><code class="xref chpl chpl-param docutils literal notranslate"><span class="pre">alignment</span></code></a> is
greater than 0, the memory will be aligned to that alignment.</p>
<p>If not enough memory is available and checks are enabled, this method
will halt the program.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>n</strong> â The number of bytes to allocate.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A <code class="docutils literal notranslate"><span class="pre">c_ptr(void)</span></code> to the allocated memory.</p>
</dd>
</dl>
</dd></dl>

<dl class="chpl method">
<dt class="sig sig-object chpl" id="Allocators.bumpPtrMemPool.deallocate">
<em class="property"><span class="pre">proc</span> </em><span class="sig-name descname"><span class="pre">deallocate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">p:</span> <span class="pre">c_ptr(void)</span></em><span class="sig-paren">)</span><a class="headerlink" href="#Allocators.bumpPtrMemPool.deallocate" title="Link to this definition">Â¶</a></dt>
<dd><p>This is a stub method that does nothing. All memory owned by this
allocator is deallocated when the allocator is destroyed.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>p</strong> â The pointer to the allocated memory.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="GPU.html" class="btn btn-neutral float-left" title="GPU" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CTypes.html" class="btn btn-neutral float-right" title="CTypes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Hewlett Packard Enterprise Development LP.</p>
  </div>

   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>
 



</body>
</html>