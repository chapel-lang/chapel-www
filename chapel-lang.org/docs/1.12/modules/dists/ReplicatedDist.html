

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Module: ReplicatedDist &mdash; Chapel Documentation 1.12 1.12.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../../_static/style.css" type="text/css" />
  

  
    <link rel="top" title="Chapel Documentation 1.12 1.12.0 documentation" href="../../index.html"/>
        <link rel="up" title="Distributions" href="../distributions.html"/>
        <link rel="next" title="Module: BlockCycDim" href="dims/BlockCycDim.html"/>
        <link rel="prev" title="Module: PrivateDist" href="PrivateDist.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="../../index.html" class="fa fa-home"> Chapel Documentation</a>
        
        
<?php   // Variables given by sphinx 
   $chplTitle = "1.12";   $pagename = "./modules/dists/ReplicatedDist";   include "../../versionButton.php";   ?>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/README.html">Quickstart Instructions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/README.html#quick-start-instructions">Quick Start Instructions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/README.html#what-s-next">What&#8217;s next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../usingchapel/index.html">Using Chapel</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/prereqs.html">Chapel Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/chplenv.html">Setting up Your Environment for Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/building.html">Building Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/compiling.html">Compiling Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/executing.html">Executing Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/multilocale.html">Multilocale Chapel Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/launcher.html">Chapel Launchers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/tasks.html">Chapel Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/debugging.html">Debugging Chapel Programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../usingchapel/bugs.html">Reporting Chapel Bugs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../platforms/index.html">Platform-Specific Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/cray.html">Using Chapel on Cray Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/cygwin.html">Using Chapel on Cygwin</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/ibm.html">Using Chapel on IBM Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/knc.html">Using Chapel on Intel Xeon Phi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/macosx.html">Using Chapel on Mac OS X</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/marenostrum.html">Using Chapel on MareNostrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../platforms/sgi.html">Using Chapel on SGI Altix</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../builtins.html">Built-in Types and Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../internal/Atomics.html">Atomics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelArray.html">Domain and Array Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelComplex_forDocs.html">Complex</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelIO.html">IO Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelIteratorSupport.html">Vectorizing Iterator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelLocale.html">Locales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelRange.html">Ranges</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelSyncvar.html">Synchronization Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/ChapelTuple.html">Tuples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../internal/UtilMisc_forDocs.html">Misc Functions</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../standardlibrary.html">Standard Library</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../distributions.html">Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../layouts.html">Layouts</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../technotes/index.html">Technical Notes</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/allocators.html">Chapel&#8217;s Use of Allocators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/atomics.html">Runtime Support for Atomics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/auxIO.html">Auxiliary I/O Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/chpl-ipe.html">Interactive Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/chpldoc.html">Documenting Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/dsi.html">Domain Map Standard Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/extern.html">C Interoperability</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/firstClassFns.html">First-class Functions in Chapel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/libraries.html">Exporting Chapel as a Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/llvm.html">LLVM Support</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/local.html">The &#8216;local&#8217; Statement</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/localeModels.html">Locale Models</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/main.html">Support for main() Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/module_search.html">Module Search Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/reduceIntents.html">Reduce Intents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/sets.html">Associative Set Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../technotes/subquery.html">Querying a Local Subdomain</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../tools/index.html">Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../tools/chplvis/index.html">chplvis</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../../index.html">Chapel Documentation 1.12</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Docs</a> &raquo;</li>
      
          <li><a href="../standardlibrary.html">Standard Library</a> &raquo;</li>
      
          <li><a href="../distributions.html">Distributions</a> &raquo;</li>
      
    <li>Module: ReplicatedDist</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="../../_sources/modules/dists/ReplicatedDist.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <span class="target" id="module-ReplicatedDist"></span><div class="section" id="module-replicateddist">
<h1>Module: ReplicatedDist<a class="headerlink" href="#module-replicateddist" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="ReplicatedDist.ReplicatedDist">
<em class="property">class </em><tt class="descname">ReplicatedDist</tt><a class="headerlink" href="#ReplicatedDist.ReplicatedDist" title="Permalink to this definition">¶</a></dt>
<dd><p>This Replicated distribution causes a domain and its arrays
to be replicated across the desired locales (all the locales by default).
An array receives a distinct set of elements - a &#8220;replicand&#8221; -
allocated on each locale.</p>
<p>In other words, a ReplicatedDist-distributed domain has
an implicit additional dimension - over the locales,
making it behave as if there is one copy of its indices per locale.</p>
<p>Consistency among the replicands is not preserved automatically.
That is, changes to one replicand of an array are never propagated to
the other replicands by the distribution implementation.
If desired, consistency needs to be maintained by the user.</p>
<p>Replication over locales is observable when:</p>
<ul class="simple">
<li>iterating over a domain or array</li>
<li>printing with <tt class="docutils literal"><span class="pre">writeln()</span></tt> et al.</li>
<li>zippering, when the replicated domain/array is
the first among the zippered items</li>
<li>assigning into the replicated array
(each replicand gets a copy)</li>
<li>inquiring about the domain&#8217;s <tt class="docutils literal"><span class="pre">numIndices</span></tt>
or the array&#8217;s <tt class="docutils literal"><span class="pre">numElements</span></tt></li>
<li>accessing array element(s) from a locale <em>not</em> in the set of desired locales,
i.e. from a locale which the array is not replicated onto.
Upon such an access, an out-of-bounds error is reported.</li>
</ul>
<p>Only the replicand <em>on the current locale</em> is accessed
(i.e. existence of multiple replicands is not observable) when:</p>
<ul class="simple">
<li>examining certain domain properties:
<tt class="docutils literal"><span class="pre">dim(d)</span></tt>, <tt class="docutils literal"><span class="pre">dims()</span></tt>, <tt class="docutils literal"><span class="pre">low</span></tt>, <tt class="docutils literal"><span class="pre">high</span></tt>, <tt class="docutils literal"><span class="pre">stride</span></tt>
&#8211; not <tt class="docutils literal"><span class="pre">numIndices</span></tt></li>
<li>indexing into an array</li>
<li>zippering, when the first zippered item is not replicated</li>
<li>assigning to a non-replicated array,
i.e. the replicated array is on the right-hand side of the assignment</li>
<li>there is only a single locale
(trivially: there is only one replicand in this case)</li>
</ul>
<p>E.g. when iterating, the number of iterations will be (the number of
locales involved) times (the number of iterations over this domain if
it were distributed with the default distribution).</p>
<p>Note that the above behavior may change in the future. In particular,
we are considering changing it so that replication is never observable.
For example, only the local replicand would be accessed in all cases.</p>
<p><strong>Example</strong></p>
<blockquote>
<div><div class="highlight-chapel"><div class="highlight"><pre><span class="kd">const</span> <span class="nx">Dbase</span> <span class="o">=</span> <span class="p">{</span><span class="mi">1</span><span class="o">..</span><span class="mi">5</span><span class="p">};</span>  <span class="c1">// a default-distributed domain</span>
<span class="kd">const</span> <span class="nx">Drepl</span><span class="p">:</span> <span class="k">domain</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="k">dmapped</span> <span class="nx">ReplicatedDist</span><span class="p">()</span> <span class="o">=</span> <span class="nx">Dbase</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Abase</span><span class="p">:</span> <span class="p">[</span><span class="nx">Dbase</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">Arepl</span><span class="p">:</span> <span class="p">[</span><span class="nx">Drepl</span><span class="p">]</span> <span class="kt">int</span><span class="p">;</span>

<span class="c1">// only the current locale&#39;s replicand is accessed</span>
<span class="nx">Arepl</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span><span class="p">;</span>

<span class="c1">// these iterate over Dbase;</span>
<span class="c1">// only the current locale&#39;s replicand is accessed</span>
<span class="k">forall</span> <span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">r</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">Abase</span><span class="p">,</span><span class="nx">Arepl</span><span class="p">)</span> <span class="k">do</span> <span class="nx">b</span> <span class="o">=</span> <span class="nx">r</span><span class="p">;</span>
<span class="nx">Abase</span> <span class="o">=</span> <span class="nx">Arepl</span><span class="p">;</span>

<span class="c1">// these iterate over Drepl; each replicand of Drepl</span>
<span class="c1">// will be zippered against (and copied from) the entire Abase</span>
<span class="k">forall</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">Arepl</span><span class="p">,</span><span class="nx">Abase</span><span class="p">)</span> <span class="k">do</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">b</span><span class="p">;</span>
<span class="nx">Arepl</span> <span class="o">=</span> <span class="nx">Abase</span><span class="p">;</span>

<span class="c1">// sequential zippering will detect difference in sizes</span>
<span class="c1">// (if multiple locales)</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">b</span><span class="p">,</span><span class="nx">r</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">Abase</span><span class="p">,</span><span class="nx">Arepl</span><span class="p">)</span> <span class="o">..</span><span class="p">.</span> <span class="c1">// error</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">r</span><span class="p">,</span><span class="nx">b</span><span class="p">)</span> <span class="kd">in</span> <span class="k">zip</span><span class="p">(</span><span class="nx">Arepl</span><span class="p">,</span><span class="nx">Abase</span><span class="p">)</span> <span class="o">..</span><span class="p">.</span> <span class="c1">// error</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>Constructor Arguments</strong></p>
<p>The <tt class="docutils literal"><span class="pre">ReplicatedDist</span></tt> class constructor is defined as follows:</p>
<blockquote>
<div><div class="highlight-chapel"><div class="highlight"><pre><span class="k">proc</span> <span class="nf">ReplicatedDist</span><span class="p">(</span>
  <span class="nx">targetLocales</span><span class="p">:</span> <span class="p">[]</span> <span class="nx">locale</span> <span class="o">=</span> <span class="nx">Locales</span><span class="p">,</span>
  <span class="nx">purposeMessage</span><span class="p">:</span> <span class="kt">string</span> <span class="o">=</span> <span class="s">&quot;used to create a ReplicatedDist&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div></blockquote>
<p>The array <tt class="docutils literal"><span class="pre">targetLocales</span></tt> must be &#8220;consistent&#8221;, as defined below.</p>
<p>The optional <tt class="docutils literal"><span class="pre">purposeMessage</span></tt> may be useful for debugging
when the constructor encounters an error.</p>
<p><strong>Features/Limitations</strong></p>
<ul class="simple">
<li>Only rectangular domains are presently supported.</li>
<li>Serial iteration over a replicated domain (or array) visits the indices
(or array elements) of all replicands <em>from the current locale</em>.</li>
<li>When replicating over user-provided array of locales, that array
must be &#8220;consistent&#8221; (see below).</li>
</ul>
<p>&#8220;Consistent&#8221; array requirement:</p>
<ul class="simple">
<li>The array of desired locales, if passed explicitly as <tt class="docutils literal"><span class="pre">targetLocales</span></tt>
to the ReplicatedDist constructor, must be &#8220;consistent&#8221;.</li>
<li>The array <tt class="docutils literal"><span class="pre">A</span></tt> is &#8220;consistent&#8221; if
for each <tt class="docutils literal"><span class="pre">ix</span></tt> in <tt class="docutils literal"><span class="pre">A.domain</span></tt>, this holds: <tt class="docutils literal"><span class="pre">A[ix].id</span> <span class="pre">==</span> <span class="pre">ix</span></tt>.</li>
<li>Tip: if the domain of your <tt class="docutils literal"><span class="pre">targetLocales</span></tt> cannot be described
as a rectangular domain (whether strided, multi-dimensional,
and/or sparse), make the domain associative over the <cite>int</cite> type.</li>
</ul>
</dd></dl>

</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="dims/BlockCycDim.html" class="btn btn-neutral float-right" title="Module: BlockCycDim">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="PrivateDist.html" class="btn btn-neutral" title="Module: PrivateDist"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Cray Inc.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.12.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  
 

</body>
</html>
